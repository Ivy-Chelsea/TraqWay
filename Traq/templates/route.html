<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TraQway</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='route.css') }}">
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_ACTUAL_API_KEY&libraries=places"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <header>
        <div class="nav-menu-icon">
            <img src="{{url_for('static', filename='images/logo.png') }}" alt="Menu">
        </div>
        <h1>TraQway</h1>
    </header>
    <main>
        <section class="welcome">
            <h2>Find stages within the CBD</h2>
            <p>Need to find stage locations or discover which SACCOs are where? TraQway's got you covered!</p>
            <img src="{{url_for('static', filename='images/bus1.png') }}" alt="Welcome Travel" class="welcome-image">
        </section>
        <section class="search">
            <h3>Safiri Salama na TraqWay!</h3>
            <form id="search-form">
                <label for="from-location"></label>
                <input type="text" id="from-location" placeholder="where are you?">
                
                <label for="to-location"></label>
                <input type="text" id="to-location" placeholder="Where are you going to?">
                
                <label for="travel-mode">Travel Mode:</label>
                <select id="travel-mode">
                    <option value="bus">Bus</option>
                    <option value="matatu">Matatu</option>
                    <option value="walking">Walking</option>
                </select>
                
                <label for="travel-date"></label>
                <input type="date" id="travel-date">
                
                <button type="button" onclick="searchRoutes()">Search</button>
            </form>
            <div id="fare-estimate">
                <h3>Fare Estimate:</h3>
                <p id="fare"></p>
            </div>
            <div id="location-suggestions"></div>
            <img src="{{url_for('static', filename='images/bus1.png') }}" alt="Search Travel" class="search-image">
        </section>
        <section id="map">
            <h2>Interactive Map</h2>
            <div id="map-container"></div>
        </section>
        <section id="alerts">
            <h2>Real-Time Alerts</h2>
            <div id="alert-container"></div>
        </section>
    </main>
    <footer>
        <p>Â© 2024 TraQway</p>
    </footer>
    <script>
        $(document).ready(function() {
            $('#from-location, #to-location').on('input', function() {
                var input = $(this).val();
                console.log('Input:', input); // Debugging statement
                var data = null;

                const xhr = new XMLHttpRequest();
                xhr.withCredentials = true;

                xhr.addEventListener('readystatechange', function () {
                    if (this.readyState === this.DONE) {
                        console.log('Response:', this.responseText); // Debugging statement
                        var response = JSON.parse(this.responseText);
                        var suggestions = response.results.map(function(result) {
                            return '<p>' + result.formatted_address + '</p>';
                        }).join('');
                        $('#location-suggestions').html(suggestions);
                    }
                });

                var apiUrl = 'https://google-map-places.p.rapidapi.com/maps/api/geocode/json?address=' + encodeURIComponent(input) + '&language=en&region=en&result_type=administrative_area_level_1&location_type=APPROXIMATE';
                console.log('API URL:', apiUrl); // Debugging statement
                xhr.open('GET', apiUrl);
                xhr.setRequestHeader('x-rapidapi-key', '07d340254fmshd96cb1998e5538ap18046djsn50e982672094');
                xhr.setRequestHeader('x-rapidapi-host', 'google-map-places.p.rapidapi.com');

                xhr.send(data);
            });
        });
    </script>
</body>
</html>
